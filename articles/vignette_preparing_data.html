<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preparing data for gcamfaostat • gcamfaostat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Preparing data for gcamfaostat">
<meta property="og:description" content="gcamfaostat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gcamfaostat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/vignette_preparing_data.html">Preparing Data</a>
    </li>
    <li>
      <a href="../articles/vignette_processing_flow.html">Processing Flow</a>
    </li>
    <li>
      <a href="../articles/vignette_use_cases.html">Use Cases</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/vignette_visualization.html">
    <span class="fa fa-file-image-o"></span>
     
    Visualization
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../articles/vignette_news.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jgcri/gcamfaostat/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_preparing_data_files/kePrint-0.0.1/kePrint.js"></script><link href="vignette_preparing_data_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Preparing data for gcamfaostat</h1>
            
            <h4 data-toc-skip class="date">2024-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jgcri/gcamfaostat/blob/HEAD/vignettes/vignette_preparing_data.Rmd" class="external-link"><code>vignettes/vignette_preparing_data.Rmd</code></a></small>
      <div class="hidden name"><code>vignette_preparing_data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>gcamfaostat</code> tool is designed to streamline the
processing and synthesis of raw data sourced from <a href="https://www.fao.org/faostat/en/#data" class="external-link">FAOSTAT</a>. The initial
phase of this process involves data procurement, with a critical
awareness of FAOSTAT’s ongoing data updates. These updates encompass a
spectrum of improvements, including, e.g., the addition of historical
data for new countries and items, data completion for previously missing
entries, and refinements such as changes in country nomenclature. This
dynamic data landscape underscores the need for a robust and adaptable
approach in the <code>gcamfaostat</code> workflow. Here we describe a
few key functions in <code>gcamdatafaostat</code> created to procure the
raw data and facilitate the processing.</p>
<p>When <code>gcamfaostat</code> is downloaded, preprocessed FAOSTAT
data, i.e., output of the <code>xfaostat_L101_RawDataPreProc*</code>
modules, are stored in the <a href="https://github.com/JGCRI/gcamfaostat/blob/main/data/PREBUILT_DATA.rda" class="external-link">Prebuilt
Data</a> of the package. * The package can be run with using those data,
but make sure <code>Process_Raw_FAO_Data &lt;- FALSE</code> in
<code>constants.R</code>. * The prebuilt data were generated using
FAOSTAT data archived in Zenodo address specified in the
<code>FF_download_RemoteArchive</code> function <span class="citation">(Zhao 2023)</span>.</p>
<div class="section level3">
<h3 id="get-the-latest-faostat-metadata">1. Get the latest FAOSTAT Metadata<a class="anchor" aria-label="anchor" href="#get-the-latest-faostat-metadata"></a>
</h3>
<p><a href="https://jgcri.github.io/gcamfaostat/reference/FAOSTAT_metadata.html"><code>FAOSTAT_metadata()</code></a></p>
<ul>
<li>Accessing API and returning a data frame of metadata</li>
</ul>
</div>
<div class="section level3">
<h3 id="generate-the-metadata-for-the-gcamfaostat-input-data">2. Generate the metadata for the <code>gcamfaostat</code> input
data<a class="anchor" aria-label="anchor" href="#generate-the-metadata-for-the-gcamfaostat-input-data"></a>
</h3>
<p><a href="https://jgcri.github.io/gcamfaostat/reference/gcamfaostat_metadata.html"><code>gcamfaostat_metadata()</code></a></p>
<ul>
<li>The function will save the latest FAOSTAT metadata to the <a href="https://github.com/JGCRI/gcamfaostat/tree/main/inst/extdata/aglu/FAO/FAOSTAT/metadata_log" class="external-link">metadata_log</a><br>
</li>
<li>The function will access both the latest FAOSTAT metadata and local
data information and returns a summary table including the dataset
information needed for gcamfaostat (see <strong>Table 1</strong>
below).<br>
</li>
<li>The dataset code needed were specified in the function to get a
subset of the FAOSTAT metadata. The function will return only dataset
code required when setting
<code>OnlyReturnDatasetCodeRequired = FALSE</code>.<br>
</li>
<li>The function will check whether FAOSTAT raw data exists locally
(<code>Exist_Local</code>) and in <a href="https://github.com/JGCRI/gcamfaostat/blob/main/data/PREBUILT_DATA.rda" class="external-link">Prebuilt
Data</a> (<code>Exist_Prebuilt</code>). If <code>Exist_Prebuilt</code>
is <code>TRUE</code> for all dataset, the package is ready to be built
based on the Prebuilt package data.<br>
</li>
<li>
<code>FAO update data</code> and <code>FAO size</code> indicate the
information based on the latest FAOSTAT metadata.</li>
</ul>
<strong>Table 1. FAOSTAT dataset processed in gcamfaostat</strong>
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Dataset Code
</th>
<th style="text-align:left;">
Dataset Name
</th>
<th style="text-align:left;">
Exist_Local
</th>
<th style="text-align:left;">
Exist_Prebuilt
</th>
<th style="text-align:left;">
FAO update date
</th>
<th style="text-align:left;">
FAO size
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
CB
</td>
<td style="text-align:left;">
Food Balances: Commodity Balances (non-food) (2010-)
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-08-08
</td>
<td style="text-align:left;">
1MB
</td>
</tr>
<tr>
<td style="text-align:left;">
FBS
</td>
<td style="text-align:left;">
Food Balances: Food Balances (2010-)
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-09-04
</td>
<td style="text-align:left;">
55MB
</td>
</tr>
<tr>
<td style="text-align:left;">
FBSH
</td>
<td style="text-align:left;">
Food Balances: Food Balances (-2013, old methodology and population)
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-03-10
</td>
<td style="text-align:left;">
69MB
</td>
</tr>
<tr>
<td style="text-align:left;">
FO
</td>
<td style="text-align:left;">
Forestry: Forestry Production and Trade
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-12-21
</td>
<td style="text-align:left;">
15MB
</td>
</tr>
<tr>
<td style="text-align:left;">
OA
</td>
<td style="text-align:left;">
Population and Employment: Annual population
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2022-10-24
</td>
<td style="text-align:left;">
2MB
</td>
</tr>
<tr>
<td style="text-align:left;">
PD
</td>
<td style="text-align:left;">
Prices: Deflators
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-11-07
</td>
<td style="text-align:left;">
1MB
</td>
</tr>
<tr>
<td style="text-align:left;">
PP
</td>
<td style="text-align:left;">
Prices: Producer Prices
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-12-19
</td>
<td style="text-align:left;">
10MB
</td>
</tr>
<tr>
<td style="text-align:left;">
QCL
</td>
<td style="text-align:left;">
Production: Crops and livestock products
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-12-18
</td>
<td style="text-align:left;">
32MB
</td>
</tr>
<tr>
<td style="text-align:left;">
RFN
</td>
<td style="text-align:left;">
Land, Inputs and Sustainability: Fertilizers by Nutrient
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-07-05
</td>
<td style="text-align:left;">
2MB
</td>
</tr>
<tr>
<td style="text-align:left;">
RL
</td>
<td style="text-align:left;">
Land, Inputs and Sustainability: Land Use
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-07-10
</td>
<td style="text-align:left;">
2MB
</td>
</tr>
<tr>
<td style="text-align:left;">
SCL
</td>
<td style="text-align:left;">
Food Balances: Supply Utilization Accounts (2010-)
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-09-04
</td>
<td style="text-align:left;">
72MB
</td>
</tr>
<tr>
<td style="text-align:left;">
TCL
</td>
<td style="text-align:left;">
Trade: Crops and livestock products
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-12-13
</td>
<td style="text-align:left;">
244MB
</td>
</tr>
<tr>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
Trade: Detailed trade matrix
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
2023-11-23
</td>
<td style="text-align:left;">
446MB
</td>
</tr>
</tbody>
</table>
<p>Note that if Exist_Prebuilt is <code>TRUE</code> for a dataset, it
suggests the raw data was saved in the Prebuilt data. And if
Exist_Prebuilt is <code>TRUE</code> for all dataset, the package is
ready to be built based on the Prebuilt data.</p>
</div>
<div class="section level3">
<h3 id="download-faostat-raw-data">3. Download FAOSTAT raw data<a class="anchor" aria-label="anchor" href="#download-faostat-raw-data"></a>
</h3>
<p><a href="https://jgcri.github.io/gcamfaostat/reference/FF_download_RemoteArchive.html"><code>FF_download_RemoteArchive()</code></a></p>
<ul>
<li>The function downloads the FAOSTAT raw data needed for the package
from a remote archive.<br>
</li>
<li>The default Zenodo archive currently included in the function
includes a snapshot of FAOSTAT data to ensure replicability.<br>
</li>
<li>The archived data is consistent with the Prebuilt package data.</li>
</ul>
<p><a href="https://jgcri.github.io/gcamfaostat/reference/FF_download_FAOSTAT.html"><code>FF_download_FAOSTAT()</code></a>
* The function downloads the latest raw data from FAOSTAT.</p>
<p>Two functions above are created for downloading the raw data from a
remote archive or the FAOSTAT API (latest data). The dataset code
variable in the two functions, if including all, can be generated using
<code>gcamfaostat_metadata(OnlyReturnDatasetCodeRequired = T)</code>.</p>
</div>
<div class="section level3">
<h3 id="check-local-raw-data-info">4. Check local raw data info<a class="anchor" aria-label="anchor" href="#check-local-raw-data-info"></a>
</h3>
<p><a href="https://jgcri.github.io/gcamfaostat/reference/FF_rawdata_info.html"><code>FF_rawdata_info()</code></a></p>
<ul>
<li>Providing more detailed metadata information, similar to
<code>gcamfaostat_metadata</code>(which calls
<code>FF_rawdata_info</code>).<br>
</li>
<li>Indicate whether an update from FAOSTAT is potentially needed.</li>
<li>Can be used to download data if not exist.</li>
</ul>
</div>
<div class="section level3">
<h3 id="load-raw-data-into-package">5. Load raw data into package<a class="anchor" aria-label="anchor" href="#load-raw-data-into-package"></a>
</h3>
<p><a href="https://jgcri.github.io/gcamfaostat/reference/FAOSTAT_load_raw_data.html"><code>FAOSTAT_load_raw_data</code></a></p>
<ul>
<li>Loading FAOSTAT raw data, e.g., used in
<code>xfaostat_L191_RawDataPreProc*</code> modules.</li>
<li>Note that <code>.</code> in column name is substituted with
<code>_</code>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="update-the-prebulit-data">6. Update the Prebulit data<a class="anchor" aria-label="anchor" href="#update-the-prebulit-data"></a>
</h3>
<p>If users updated the FAOSTAT raw data, and run
<code>driver_drake</code> is run with
<code>Process_Raw_FAO_Data &lt;- TRUE</code> in
<code>constants.R</code>, the updated preprecessed data are stored in
drake cache. And they can be used to update <code>Prebulit data</code>
by sourcing <code>data-raw/generate_package_data.R</code>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-xin_zhao_2023_8260225" class="csl-entry">
Zhao, Xin. 2023. <span>“FAOSTAT AgLU Data Archive GCAMv7.”</span>
Zenodo. <a href="https://doi.org/10.5281/zenodo.8260225" class="external-link">https://doi.org/10.5281/zenodo.8260225</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Xin Zhao, Maksym Chepeliev, Pralit Patel, Marshall Wise, Kate Calvin, Kanishka Narayan, Chris Vernon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
